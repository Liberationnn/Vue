webpackJsonp([6],{ahFR:function(t,e){},tcnj:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("Xxa5"),r=o.n(n),s=o("exGp"),a=o.n(s),i=o("UeVD"),c=o("gyMJ"),u=o("HzVJ"),f={name:"List",data:function(){return{books:[],book:{},hasMore:!0,isLoading:!1,timer:null,isRemoving:!1}},created:function(){this.doGetBooks()},mounted:function(){var t=this,e=this.$refs.content,o=e.offsetTop;e.ontouchstart=function(n){var r=n.touches[0].pageY;e.ontouchmove=function(n){if(0===e.scrollTop){var s=n.touches[0].pageY-r;s>0&&(e.style.top=s<50?o+s+"px":o+50+"px"),e.ontouchend=function(n){s>=50&&(t.doGetBooks(),setTimeout(function(){0===t.books.length&&t.doInitBooks()},200));var r=setInterval(function(){parseInt(e.style.top)<=o?clearInterval(r):e.style.top=parseInt(e.style.top)-1+"px"},1);e.ontouchmove=e.ontouchend=null}}}}},methods:{doGetAllBooks:function(){var t=this;return a()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.c)();case 2:t.books=e.sent;case 3:case"end":return e.stop()}},e,t)}))()},doGetBooks:function(){var t=this;return a()(r.a.mark(function e(){var o,n,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.e)(6);case 2:o=e.sent,n=o.books,s=o.hasMore,t.books=[],t.books=n,t.hasMore=s;case 8:case"end":return e.stop()}},e,t)}))()},doGetMoreBooks:function(){var t=this;return a()(r.a.mark(function e(){var o,n,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.hasMore||t.isLoading){e.next=10;break}return t.isLoading=!0,e.next=4,Object(c.e)(t.books.length+3);case 4:o=e.sent,n=o.books,s=o.hasMore,t.books=n,t.hasMore=s,t.isLoading=!1;case 10:case"end":return e.stop()}},e,t)}))()},doGetBook:function(t){var e=this;return a()(r.a.mark(function o(){return r.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(c.d)(t);case 2:e.book=o.sent;case 3:case"end":return o.stop()}},o,e)}))()},doAddBook:function(t){var e=this;return a()(r.a.mark(function o(){return r.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(c.a)(t);case 2:e.doGetBooks();case 3:case"end":return o.stop()}},o,e)}))()},doUpdateBook:function(t){var e=this;return a()(r.a.mark(function o(){return r.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(c.h)(t);case 2:e.doGetBooks();case 3:case"end":return o.stop()}},o,e)}))()},doRemoveBook:function(t){var e=this;return a()(r.a.mark(function o(){var n;return r.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(e.isRemoving){o.next=9;break}return e.books=e.books.filter(function(e){return e.id!==t.id}),e.isRemoving=!0,o.next=5,Object(c.g)(t.id);case 5:n=o.sent,e.books=n.reverse().slice(0,e.books.length),e.$store.commit(u.f,t),e.isRemoving=!1;case 9:case"end":return o.stop()}},o,e)}))()},doInitBooks:function(){var t=this;return a()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.f)();case 2:t.books=e.sent;case 3:case"end":return e.stop()}},e,t)}))()},loadMore:function(){var t=this;clearTimeout(this.timer),this.timer=setTimeout(function(){var e=t.$refs.content;e.clientHeight+e.scrollTop+20>=e.scrollHeight&&t.doGetMoreBooks()},10)},addCar:function(t){this.$store.commit(u.a,t)}},components:{MHeader:i.a}},d={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("MHeader",[t._v("列表页")]),t._v(" "),o("div",{ref:"content",staticClass:"content",on:{scroll:t.loadMore}},[t.books.length?o("ul",t._l(t.books,function(e,n){return o("router-link",{key:e.bookCover+n,staticClass:"list-group-item clearfix",attrs:{to:{name:"detail",params:{id:e.id}},tag:"li"}},[o("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.bookCover,expression:"book.bookCover"}],attrs:{alt:""}}),t._v(" "),o("div",{staticClass:"wrap"},[o("h4",[t._v(t._s(e.bookName))]),t._v(" "),o("p",[t._v(t._s(e.bookInfo))]),t._v(" "),o("span",[t._v("￥ "+t._s(e.bookPrice))]),t._v(" "),o("div",[o("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(o){o.stopPropagation(),t.addCar(e)}}},[t._v("加入购物车")]),t._v(" "),o("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(o){o.stopPropagation(),t.doRemoveBook(e)}}},[t._v("删除")])])])])})):o("div",{staticClass:"text-center tip"},[t._v("下拉获取数据")])])],1)},staticRenderFns:[]};var v=o("VU/8")(f,d,!1,function(t){o("ahFR")},"data-v-0b07d72f",null);e.default=v.exports}});
//# sourceMappingURL=6.2c068fffb50622e6afed.js.map